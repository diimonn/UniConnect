<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataHub –í–£–ó–æ–≤ –†–ö</title>

    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", sans-serif;
            background: linear-gradient(180deg, #eef5ff, #ffffff);
            overflow-x: hidden;
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò ---------------------------------- */
        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(25px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade {
            animation: fadeInUp 0.8s ease forwards;
        }

        .delay-1 { animation-delay: 0.2s; }
        .delay-2 { animation-delay: 0.4s; }
        .delay-3 { animation-delay: 0.6s; }

        /* –ù–ê–í–ë–ê–† */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 60px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .navbar-logo {
            font-size: 22px;
            font-weight: bold;
            color: #0046ff;
        }

        .navbar-menu a {
            margin: 0 15px;
            color: #333;
            font-size: 16px;
            text-decoration: none;
            transition: 0.2s;
        }

        .navbar-menu a:hover {
            color: #0046ff;
        }

        /* HERO */
        .hero {
            text-align: center;
            padding: 80px 20px;
        }

        .hero-title {
            font-size: 46px;
            font-weight: 600;
            color: #2a4bdc;
        }

        .hero-subtitle {
            font-size: 18px;
            color: #555;
            max-width: 650px;
            margin: 20px auto;
        }

        /* SEARCH */
        .search-box {
            margin: 25px auto;
            width: 60%;
            display: flex;
            background: white;
            border-radius: 40px;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            animation: fadeInUp 1s ease;
        }

        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            padding: 12px;
            font-size: 16px;
        }

        .search-box button {
            background: #3478ff;
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            border: none;
            font-size: 16px;
            cursor: pointer;
            transition: 0.25s;
        }

        .search-box button:hover {
            background: #0050ff;
        }

        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 40px;
        }

        .stat-card {
            background: white;
            width: 220px;
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: 0.25s;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.18);
        }

        .stat-card-number {
            font-size: 32px;
            font-weight: bold;
            color: #3a57df;
        }

        .stat-card-text {
            color: #444;
            margin-top: 8px;
        }

        /* –°–ï–ö–¶–ò–ò */
        .section-title {
            text-align: center;
            font-size: 28px;
            margin-top: 60px;
            margin-bottom: 25px;
            color: #333;
            font-weight: 600;
            animation: fadeInUp 0.8s ease;
        }

        .cards {
            display: flex;
            justify-content: center;
            gap: 25px;
            padding: 20px;
            flex-wrap: wrap;
        }

        /* –ö–ê–†–¢–û–ß–ö–ò */
        .card {
            background: white;
            padding: 25px;
            width: 260px;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: 0.25s ease;
            opacity: 0;
            animation: fadeInUp 1s ease forwards;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 26px rgba(0,70,255,0.25);
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
        }

        .card-sub {
            color: #666;
            margin-top: 8px;
            margin-bottom: 15px;
        }

        .card a {
            color: #2666ff;
            font-weight: 500;
            text-decoration: none;
        }
    </style>
</head>

<body>

    <!-- –ù–∞–≤–±–∞—Ä -->
    <div class="navbar fade">
        <div class="navbar-logo"></div>

        <div class="navbar-menu">
            <a href="#">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="universities.html">–û –í–£–ó–∞—Ö</a>
           
            <a href="#">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</a>
        </div>
    </div>

    <!-- HERO -->
    <div class="hero fade delay-1">
        <div class="hero-title">DataHub</div>
        <div class="hero-subtitle">
            –ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—ã—Å—à–∏—Ö —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. 
            –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç —Å—Ä–µ–¥–∏ –ª—É—á—à–∏—Ö –í–£–ó–æ–≤ —Å—Ç—Ä–∞–Ω—ã.
        </div>

        <div class="search-box fade delay-2">
            <input type="text" placeholder="–ü–æ–∏—Å–∫ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –ø—Ä–æ–≥—Ä–∞–º–º, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π...">
            <button>–ù–∞–π—Ç–∏</button>
        </div>

        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stats fade delay-3">
            <div class="stat-card">
                <div class="stat-card-number">120+</div>
                <div class="stat-card-text">–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-card-number">500+</div>
                <div class="stat-card-text">–ü—Ä–æ–≥—Ä–∞–º–º –æ–±—É—á–µ–Ω–∏—è</div>
            </div>
            <div class="stat-card">
                <div class="stat-card-number">50+</div>
                <div class="stat-card-text">–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤</div>
            </div>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–´–ï –†–ê–ó–î–ï–õ–´ -->
    <div class="section-title">–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã</div>

    <div class="cards">
        <div class="card delay-1">
            <div class="card-title">–û–± —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ</div>
            <div class="card-sub">–ú–∏—Å—Å–∏—è, –∏—Å—Ç–æ—Ä–∏—è, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>

        <div class="card delay-2">
            <div class="card-title">–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã</div>
            <div class="card-sub">–ë–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç, –º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞ –∏ –¥–æ–∫—Ç–æ—Ä–∞–Ω—Ç—É—Ä–∞</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>

        <div class="card delay-3">
            <div class="card-title">–ü—Ä–∏—ë–º –∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</div>
            <div class="card-sub">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è, —Å—Ä–æ–∫–∏, —Å—Ç–∏–ø–µ–Ω–¥–∏–∏</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>
    </div>

    <!-- –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ê–ó–î–ï–õ–´ -->
    <div class="section-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>

    <div class="cards">
        <div class="card delay-1">
            <div class="card-title">3D-—Ç—É—Ä</div>
            <div class="card-sub">–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è –ø–æ –∫–∞–º–ø—É—Å—É</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>

        <div class="card delay-2">
            <div class="card-title">–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ</div>
            <div class="card-sub">–û–±–º–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>

        <div class="card delay-3">
            <div class="card-title">–§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</div>
            <div class="card-sub">–°—Ä–∞–≤–Ω–∏—Ç–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</div>
            <a href="#">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí</a>
        </div>
    </div>
<!-- ==================== -->
<!-- –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢ - –ß–ê–¢ –í–ò–î–ñ–ï–¢ -->
<!-- ==================== -->
<div id="ai-chat-widget">
    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞ -->
    <button id="chat-toggle" onclick="toggleChat()">
        <span>ü§ñ</span>
        <span id="unread-badge" class="hidden">1</span>
    </button>

    <!-- –û–∫–Ω–æ —á–∞—Ç–∞ -->
    <div id="chat-container" class="hidden">
        <div class="chat-header">
            <h3>üéì DataHub –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h3>
            <button onclick="toggleChat()" class="close-btn">√ó</button>
        </div>

        <div id="chat-messages">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            <div class="message ai-message">
                –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –≤—ã–±–æ—Ä—É —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ. 
                –ú–æ–≥—É –ø–æ–º–æ—á—å —Å—Ä–∞–≤–Ω–∏—Ç—å –≤—É–∑—ã, –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∏–ª–∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏. 
                –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
            </div>
        </div>

        <div class="chat-input-area">
            <input type="text" id="chat-input" 
                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–°—Ä–∞–≤–Ω–∏ –ú–£–ò–¢ –∏ –ö–ë–¢–£' –∏–ª–∏ 'IT-–ø—Ä–æ–≥—Ä–∞–º–º—ã'"
                   onkeypress="if(event.key === 'Enter') sendMessage()">
            <button onclick="sendMessage()">‚û§</button>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ -->
        <div class="chat-quick-tips">
            <small>üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å:</small>
            <button onclick="quickQuestion('–°—Ä–∞–≤–Ω–∏ –ú–£–ò–¢ –∏ –ö–ë–¢–£')">–°—Ä–∞–≤–Ω–∏—Ç—å –≤—É–∑—ã</button>
            <button onclick="quickQuestion('–ö—É–¥–∞ –ø–æ—Å—Ç—É–ø–∏—Ç—å —Å 105 –±–∞–ª–ª–∞–º–∏?')">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</button>
            <button onclick="quickQuestion('IT-–ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –ê–ª–º–∞—Ç—ã')">IT-–ø—Ä–æ–≥—Ä–∞–º–º—ã</button>
        </div>
    </div>
</div>

<style>
    /* –°–¢–ò–õ–ò –î–õ–Ø –ß–ê–¢-–í–ò–î–ñ–ï–¢–ê */
    #ai-chat-widget {
        position: fixed;
        bottom: 25px;
        right: 25px;
        z-index: 1000;
        font-family: 'Segoe UI', sans-serif;
    }

    /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞ */
    #chat-toggle {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #3a57df, #2666ff);
        border: none;
        color: white;
        font-size: 28px;
        cursor: pointer;
        box-shadow: 0 6px 20px rgba(58, 87, 223, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        transition: all 0.3s ease;
    }

    #chat-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 25px rgba(58, 87, 223, 0.6);
    }

    #unread-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #ff4757;
        color: white;
        border-radius: 50%;
        width: 22px;
        height: 22px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }

    /* –û–∫–Ω–æ —á–∞—Ç–∞ */
    #chat-container {
        width: 380px;
        height: 500px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: column;
        margin-bottom: 20px;
        animation: slideInUp 0.3s ease;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ */
    .chat-header {
        background: linear-gradient(135deg, #3a57df, #2666ff);
        color: white;
        padding: 18px 20px;
        border-radius: 20px 20px 0 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chat-header h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
    }

    .close-btn {
        background: none;
        border: none;
        color: white;
        font-size: 28px;
        cursor: pointer;
        line-height: 1;
        padding: 0;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π */
    #chat-messages {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        background: #f8fafc;
    }

    /* –°–æ–æ–±—â–µ–Ω–∏—è */
    .message {
        margin-bottom: 15px;
        max-width: 85%;
        padding: 12px 16px;
        border-radius: 18px;
        line-height: 1.4;
        word-wrap: break-word;
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .ai-message {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 18px 18px 18px 4px;
        margin-right: auto;
    }

    .user-message {
        background: linear-gradient(135deg, #3a57df, #2666ff);
        color: white;
        border-radius: 18px 18px 4px 18px;
        margin-left: auto;
    }

    /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
    .chat-input-area {
        display: flex;
        padding: 15px;
        border-top: 1px solid #e2e8f0;
        background: white;
    }

    .chat-input-area input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #e2e8f0;
        border-radius: 25px;
        font-size: 14px;
        outline: none;
        transition: border 0.2s;
    }

    .chat-input-area input:focus {
        border-color: #3a57df;
    }

    .chat-input-area button {
        background: linear-gradient(135deg, #3a57df, #2666ff);
        color: white;
        border: none;
        width: 44px;
        border-radius: 50%;
        margin-left: 10px;
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
    }

    .chat-input-area button:hover {
        transform: scale(1.05);
    }

    /* –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
    .chat-quick-tips {
        padding: 12px 15px;
        background: #f1f5f9;
        border-top: 1px solid #e2e8f0;
        border-radius: 0 0 20px 20px;
    }

    .chat-quick-tips small {
        display: block;
        color: #64748b;
        margin-bottom: 8px;
        font-size: 12px;
    }

    .chat-quick-tips button {
        background: white;
        border: 1px solid #cbd5e1;
        color: #475569;
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 12px;
        margin-right: 8px;
        margin-bottom: 5px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .chat-quick-tips button:hover {
        background: #f8fafc;
        border-color: #3a57df;
        color: #3a57df;
    }

    /* –£—Ç–∏–ª–∏—Ç—ã */
    .hidden {
        display: none !important;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è) */
    .message table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0;
        font-size: 13px;
        background: white;
        border-radius: 10px;
        overflow: hidden;
    }

    .message th {
        background: #f1f5f9;
        padding: 10px;
        text-align: left;
        font-weight: 600;
        color: #475569;
        border-bottom: 2px solid #e2e8f0;
    }

    .message td {
        padding: 10px;
        border-bottom: 1px solid #e2e8f0;
    }

    .message tr:last-child td {
        border-bottom: none;
    }

    /* –ë–µ–π–¥–∂ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ */
    .university-badge {
        display: inline-block;
        background: #e0f2fe;
        color: #0369a1;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        margin: 3px;
        font-weight: 500;
    }
</style>

<script>
    // ====================
    // –§–£–ù–ö–¶–ò–ò –ß–ê–¢–ê
    // ====================
    
    const API_URL = 'http://localhost:5000/api/ai/ask';
    let isChatOpen = false;
    let hasUnread = false;

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–∞—Ç–∞
    function toggleChat() {
        const chatContainer = document.getElementById('chat-container');
        const toggleBtn = document.getElementById('chat-toggle');
        
        if (isChatOpen) {
            chatContainer.classList.add('hidden');
            toggleBtn.style.transform = 'scale(1)';
        } else {
            chatContainer.classList.remove('hidden');
            toggleBtn.style.transform = 'scale(1.1)';
            
            // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
            if (hasUnread) {
                document.getElementById('unread-badge').classList.add('hidden');
                hasUnread = false;
            }
        }
        
        isChatOpen = !isChatOpen;
    }

    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    async function sendMessage() {
        const input = document.getElementById('chat-input');
        const message = input.value.trim();
        
        if (!message) return;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        addMessage(message, 'user');
        input.value = '';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç"
        showTypingIndicator();
        
        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ question: message })
            });
            
            const data = await response.json();
            
            // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
            removeTypingIndicator();
            
            if (data.success) {
                addMessage(data.answer, 'ai');
            } else {
                addMessage(`–û—à–∏–±–∫–∞: ${data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'ai');
            }
            
        } catch (error) {
            removeTypingIndicator();
            addMessage('‚ö†Ô∏è –ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ backend –Ω–∞ –ø–æ—Ä—Ç—É 8000.', 'ai');
            console.error('–û—à–∏–±–∫–∞:', error);
        }
    }

    // –ë—ã—Å—Ç—Ä—ã–π –≤–æ–ø—Ä–æ—Å
    function quickQuestion(question) {
        document.getElementById('chat-input').value = question;
        sendMessage();
    }

    // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
    function addMessage(text, sender) {
        const messagesDiv = document.getElementById('chat-messages');
        const messageDiv = document.createElement('div');
        
        messageDiv.className = `message ${sender}-message`;
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç (Markdown -> HTML)
        let formattedText = formatMessage(text);
        
        messageDiv.innerHTML = formattedText;
        messagesDiv.appendChild(messageDiv);
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å–ª–∏ —á–∞—Ç –∑–∞–∫—Ä—ã—Ç
        if (sender === 'ai' && !isChatOpen) {
            document.getElementById('unread-badge').classList.remove('hidden');
            hasUnread = true;
        }
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    function formatMessage(text) {
        // –ó–∞–º–µ–Ω—è–µ–º Markdown –Ω–∞ HTML
        let html = text
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/\n/g, '<br>')
            .replace(/üéì/g, 'üéì ')
            .replace(/‚≠ê/g, '‚≠ê ')
            .replace(/üìç/g, 'üìç ')
            .replace(/üíª/g, 'üíª ')
            .replace(/üåç/g, 'üåç ')
            .replace(/‚öñÔ∏è/g, '‚öñÔ∏è ')
            .replace(/üí°/g, '<br>üí° ')
            .replace(/üèÜ/g, 'üèÜ ');
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü
        if (text.includes('| –ü–∞—Ä–∞–º–µ—Ç—Ä |')) {
            html = formatTable(text);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ–π–¥–∂–µ–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤
        html = html.replace(/\[(.*?)\]/g, '<span class="university-badge">$1</span>');
        
        return html;
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
    function formatTable(text) {
        const lines = text.trim().split('\n');
        let tableHtml = '<div style="overflow-x: auto;"><table>';
        
        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            
            if (line.startsWith('|') && line.endsWith('|')) {
                const cells = line.split('|').map(cell => cell.trim()).filter(cell => cell);
                
                if (i === 0) {
                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                    tableHtml += '<thead><tr>';
                    cells.forEach(cell => {
                        tableHtml += `<th>${cell}</th>`;
                    });
                    tableHtml += '</tr></thead><tbody>';
                } else if (line.includes('---')) {
                    // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                    continue;
                } else {
                    // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
                    tableHtml += '<tr>';
                    cells.forEach(cell => {
                        tableHtml += `<td>${cell}</td>`;
                    });
                    tableHtml += '</tr>';
                }
            } else if (tableHtml.includes('<table>')) {
                // –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞—á–∞–ª–∞—Å—å, –Ω–æ —ç—Ç–æ –Ω–µ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã, –∑–∞–∫—Ä—ã–≤–∞–µ–º –µ—ë
                tableHtml += '</tbody></table></div><br>' + line;
                break;
            }
        }
        
        if (tableHtml.includes('<thead>') && !tableHtml.includes('</tbody>')) {
            tableHtml += '</tbody></table></div>';
        }
        
        return tableHtml;
    }

    // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç"
    function showTypingIndicator() {
        const messagesDiv = document.getElementById('chat-messages');
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typing-indicator';
        typingDiv.className = 'message ai-message';
        typingDiv.innerHTML = '<div class="typing"><span></span><span></span><span></span></div>';
        messagesDiv.appendChild(typingDiv);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    function removeTypingIndicator() {
        const typing = document.getElementById('typing-indicator');
        if (typing) typing.remove();
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    window.addEventListener('load', () => {
        setTimeout(() => {
            if (!localStorage.getItem('chatSeen')) {
                toggleChat();
                localStorage.setItem('chatSeen', 'true');
            }
        }, 3000);
    });

    // –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø–µ—á–∞—Ç–∏
    const style = document.createElement('style');
    style.textContent = `
        .typing {
            display: flex;
            align-items: center;
            height: 20px;
        }
        .typing span {
            width: 8px;
            height: 8px;
            background: #cbd5e1;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite both;
        }
        .typing span:nth-child(2) { animation-delay: 0.2s; }
        .typing span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-6px); }
        }
    `;
    document.head.appendChild(style);
</script>
</body>
</html>
